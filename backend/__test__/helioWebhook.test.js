// tests/helioWebhook.test.ts
import request from "supertest";
import { app } from "../src";
describe("Helio Webhook", () => {
    it("should credit wallet and issue ticket on confirmed payment", async () => {
        const res = await request(app).post("/api/webhooks/helio").send({
            userId: "mock-user",
            amount: 50,
            eventId: "mock-event",
            status: "confirmed",
            signature: process.env.HELIO_SECRET,
        });
        expect(res.status).toBe(200);
        expect(res.body.success).toBe(true);
        expect(res.body.ticket).toBeDefined();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVsaW9XZWJob29rLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJoZWxpb1dlYmhvb2sudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw2QkFBNkI7QUFDN0IsT0FBTyxPQUFPLE1BQU0sV0FBVyxDQUFDO0FBQ2hDLE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFFN0IsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7SUFDN0IsRUFBRSxDQUFDLDREQUE0RCxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzFFLE1BQU0sR0FBRyxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUM5RCxNQUFNLEVBQUUsV0FBVztZQUNuQixNQUFNLEVBQUUsRUFBRTtZQUNWLE9BQU8sRUFBRSxZQUFZO1lBQ3JCLE1BQU0sRUFBRSxXQUFXO1lBQ25CLFNBQVMsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVk7U0FDcEMsQ0FBQyxDQUFDO1FBRUgsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDN0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3hDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0ZXN0cy9oZWxpb1dlYmhvb2sudGVzdC50c1xyXG5pbXBvcnQgcmVxdWVzdCBmcm9tIFwic3VwZXJ0ZXN0XCI7XHJcbmltcG9ydCB7IGFwcCB9IGZyb20gXCIuLi9zcmNcIjtcclxuXHJcbmRlc2NyaWJlKFwiSGVsaW8gV2ViaG9va1wiLCAoKSA9PiB7XHJcbiAgaXQoXCJzaG91bGQgY3JlZGl0IHdhbGxldCBhbmQgaXNzdWUgdGlja2V0IG9uIGNvbmZpcm1lZCBwYXltZW50XCIsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QoYXBwKS5wb3N0KFwiL2FwaS93ZWJob29rcy9oZWxpb1wiKS5zZW5kKHtcclxuICAgICAgdXNlcklkOiBcIm1vY2stdXNlclwiLFxyXG4gICAgICBhbW91bnQ6IDUwLFxyXG4gICAgICBldmVudElkOiBcIm1vY2stZXZlbnRcIixcclxuICAgICAgc3RhdHVzOiBcImNvbmZpcm1lZFwiLFxyXG4gICAgICBzaWduYXR1cmU6IHByb2Nlc3MuZW52LkhFTElPX1NFQ1JFVCxcclxuICAgIH0pO1xyXG5cclxuICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0JlKDIwMCk7XHJcbiAgICBleHBlY3QocmVzLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChyZXMuYm9keS50aWNrZXQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXX0=