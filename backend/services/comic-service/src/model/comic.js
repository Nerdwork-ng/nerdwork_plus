import { pgTable, uuid, text, timestamp, integer, decimal, boolean, json } from 'drizzle-orm/pg-core';
import { authUsers } from './auth.js';
export const comics = pgTable('comics', {
    id: uuid('id').primaryKey().defaultRandom(),
    creatorId: uuid('creator_id')
        .notNull()
        .references(() => authUsers.id, { onDelete: 'cascade' }), // Who created this comic
    title: text('title').notNull(),
    description: text('description'),
    author: text('author').notNull(), // Can be different from creator (for collaborations)
    artist: text('artist'),
    publisher: text('publisher'),
    genre: text('genre').notNull(),
    coverUrl: text('cover_url'),
    coverFileId: uuid('cover_file_id'), // Reference to file service
    totalPages: integer('total_pages').notNull().default(0),
    price: decimal('price', { precision: 10, scale: 2 }).notNull().default('0.00'),
    isFreemium: boolean('is_freemium').notNull().default(false),
    freePageCount: integer('free_page_count').notNull().default(0),
    // Publishing status
    status: text('status').notNull().default('draft'), // 'draft', 'published', 'archived'
    publishedAt: timestamp('published_at', { mode: 'date' }),
    isActive: boolean('is_active').notNull().default(true),
    // NFT and Web3 integration
    isNFTEligible: boolean('is_nft_eligible').notNull().default(false),
    nftContractAddress: text('nft_contract_address'),
    nftTokenId: text('nft_token_id'),
    metadata: json('metadata'), // Additional metadata like tags, ratings, etc.
    createdAt: timestamp('created_at', { mode: 'date' }).notNull().defaultNow(),
    updatedAt: timestamp('updated_at', { mode: 'date' }).notNull().defaultNow(),
});
export const comicPages = pgTable('comic_pages', {
    id: uuid('id').primaryKey().defaultRandom(),
    comicId: uuid('comic_id')
        .notNull()
        .references(() => comics.id, { onDelete: 'cascade' }),
    pageNumber: integer('page_number').notNull(),
    imageUrl: text('image_url').notNull(),
    fileId: uuid('file_id'), // Reference to file service
    altText: text('alt_text'),
    isPreview: boolean('is_preview').notNull().default(false), // For free preview pages
    // IPFS/NFT data (optional)
    ipfsHash: text('ipfs_hash'),
    ipfsUrl: text('ipfs_url'),
    createdAt: timestamp('created_at', { mode: 'date' }).notNull().defaultNow(),
    updatedAt: timestamp('updated_at', { mode: 'date' }).notNull().defaultNow(),
});
export const readingProgress = pgTable('reading_progress', {
    id: uuid('id').primaryKey().defaultRandom(),
    userId: uuid('user_id')
        .notNull()
        .references(() => authUsers.id, { onDelete: 'cascade' }),
    comicId: uuid('comic_id')
        .notNull()
        .references(() => comics.id, { onDelete: 'cascade' }),
    currentPage: integer('current_page').notNull().default(1),
    totalPages: integer('total_pages').notNull(),
    completedAt: timestamp('completed_at', { mode: 'date' }),
    lastReadAt: timestamp('last_read_at', { mode: 'date' }).notNull().defaultNow(),
    createdAt: timestamp('created_at', { mode: 'date' }).notNull().defaultNow(),
    updatedAt: timestamp('updated_at', { mode: 'date' }).notNull().defaultNow(),
});
export const comicPurchases = pgTable('comic_purchases', {
    id: uuid('id').primaryKey().defaultRandom(),
    userId: uuid('user_id')
        .notNull()
        .references(() => authUsers.id, { onDelete: 'cascade' }),
    comicId: uuid('comic_id')
        .notNull()
        .references(() => comics.id, { onDelete: 'cascade' }),
    purchasePrice: decimal('purchase_price', { precision: 10, scale: 2 }).notNull(),
    transactionId: text('transaction_id'), // Reference to wallet transaction
    purchasedAt: timestamp('purchased_at', { mode: 'date' }).notNull().defaultNow(),
});
export const comicReviews = pgTable('comic_reviews', {
    id: uuid('id').primaryKey().defaultRandom(),
    userId: uuid('user_id')
        .notNull()
        .references(() => authUsers.id, { onDelete: 'cascade' }),
    comicId: uuid('comic_id')
        .notNull()
        .references(() => comics.id, { onDelete: 'cascade' }),
    rating: integer('rating').notNull(), // 1-5 stars
    review: text('review'),
    isPublished: boolean('is_published').notNull().default(true),
    createdAt: timestamp('created_at', { mode: 'date' }).notNull().defaultNow(),
    updatedAt: timestamp('updated_at', { mode: 'date' }).notNull().defaultNow(),
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29taWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjb21pYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsT0FBTyxFQUNQLElBQUksRUFDSixJQUFJLEVBQ0osU0FBUyxFQUNULE9BQU8sRUFDUCxPQUFPLEVBQ1AsT0FBTyxFQUNQLElBQUksRUFDTCxNQUFNLHFCQUFxQixDQUFDO0FBQzdCLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFFdEMsTUFBTSxDQUFDLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLEVBQUU7SUFDdEMsRUFBRSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxhQUFhLEVBQUU7SUFDM0MsU0FBUyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUM7U0FDMUIsT0FBTyxFQUFFO1NBQ1QsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLENBQUMsRUFBRSx5QkFBeUI7SUFDckYsS0FBSyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUU7SUFDOUIsV0FBVyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUM7SUFDaEMsTUFBTSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRSxxREFBcUQ7SUFDdkYsTUFBTSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdEIsU0FBUyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDNUIsS0FBSyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUU7SUFDOUIsUUFBUSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDM0IsV0FBVyxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsRUFBRSw0QkFBNEI7SUFDaEUsVUFBVSxFQUFFLE9BQU8sQ0FBQyxhQUFhLENBQUMs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LFVBQVUsQ0FBQztTQUN0QixPQUFPLEVBQUU7U0FDVCxVQUFVLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsQ0FBQztJQUN2RCxNQUFNLEVBQUUsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFLFlBQVk7SUFDakQsTUFBTSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdEIsV0FBVyxFQUFFLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDO0lBQzVELFNBQVMsRUFBRSxTQUFTLENBQUMsWUFBWSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsVUFBVSxFQUFFO0lBQzNFLFNBQVMsRUFBRSxTQUFTLENBQUMsWUFBWSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsVUFBVSxFQUFFO0NBQzVFLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgcGdUYWJsZSxcclxuICB1dWlkLFxyXG4gIHRleHQsXHJcbiAgdGltZXN0YW1wLFxyXG4gIGludGVnZXIsXHJcbiAgZGVjaW1hbCxcclxuICBib29sZWFuLFxyXG4gIGpzb25cclxufSBmcm9tICdkcml6emxlLW9ybS9wZy1jb3JlJztcclxuaW1wb3J0IHsgYXV0aFVzZXJzIH0gZnJvbSAnLi9hdXRoLmpzJztcclxuXHJcbmV4cG9ydCBjb25zdCBjb21pY3MgPSBwZ1RhYmxlKCdjb21pY3MnLCB7XHJcbiAgaWQ6IHV1aWQoJ2lkJykucHJpbWFyeUtleSgpLmRlZmF1bHRSYW5kb20oKSxcclxuICBjcmVhdG9ySWQ6IHV1aWQoJ2NyZWF0b3JfaWQnKVxyXG4gICAgLm5vdE51bGwoKVxyXG4gICAgLnJlZmVyZW5jZXMoKCkgPT4gYXV0aFVzZXJzLmlkLCB7IG9uRGVsZXRlOiAnY2FzY2FkZScgfSksIC8vIFdobyBjcmVhdGVkIHRoaXMgY29taWNcclxuICB0aXRsZTogdGV4dCgndGl0bGUnKS5ub3ROdWxsKCksXHJcbiAgZGVzY3JpcHRpb246IHRleHQoJ2Rlc2NyaXB0aW9uJyksXHJcbiAgYXV0aG9yOiB0ZXh0KCdhdXRob3InKS5ub3ROdWxsKCksIC8vIENhbiBiZSBkaWZmZXJlbnQgZnJvbSBjcmVhdG9yIChmb3IgY29sbGFib3JhdGlvbnMpXHJcbiAgYXJ0aXN0OiB0ZXh0KCdhcnRpc3QnKSxcclxuICBwdWJsaXNoZXI6IHRleHQoJ3B1Ymxpc2hlcicpLFxyXG4gIGdlbnJlOiB0ZXh0KCdnZW5yZScpLm5vdE51bGwoKSxcclxuICBjb3ZlclVybDogdGV4dCgnY292ZXJfdXJsJyksXHJcbiAgY292ZXJGaWxlSWQ6IHV1aWQoJ2NvdmVyX2ZpbGVfaWQnKSwgLy8gUmVmZXJlbmNlIHRvIGZpbGUgc2VydmljZVxyXG4gIHRvdGFsUGFnZXM6IGludGVnZXIoJ3RvdGFsX3BhZ2VzJykubm90TnVsbCgpLmRlZmF1bHQoMCksXHJcbiAgcHJpY2U6IGRlY2ltYWwoJ3ByaWNlJywgeyBwcmVjaXNpb246IDEwLCBzY2FsZTogMiB9KS5ub3ROdWxsKCkuZGVmYXVsdCgnMC4wMCcpLFxyXG4gIGlzRnJlZW1pdW06IGJvb2xlYW4oJ2lzX2ZyZWVtaXVtJykubm90TnVsbCgpLmRlZmF1bHQoZmFsc2UpLFxyXG4gIGZyZWVQYWdlQ291bnQ6IGludGVnZXIoJ2ZyZWVfcGFnZV9jb3VudCcpLm5vdE51bGwoKS5kZWZhdWx0KDApLFxyXG4gIFxyXG4gIC8vIFB1Ymxpc2hpbmcgc3RhdHVzXHJcbiAgc3RhdHVzOiB0ZXh0KCdzdGF0dXMnKS5ub3ROdWxsKCkuZGVmYXVsdCgnZHJhZnQnKSwgLy8gJ2RyYWZ0JywgJ3B1Ymxpc2hlZCcsICdhcmNoaXZlZCdcclxuICBwdWJsaXNoZWRBdDogdGltZXN0YW1wKCdwdWJsaXNoZWRfYXQnLCB7IG1vZGU6ICdkYXRlJyB9KSxcclxuICBpc0FjdGl2ZTogYm9vbGVhbignaXNfYWN0aXZlJykubm90TnVsbCgpLmRlZmF1bHQodHJ1ZSksXHJcbiAgXHJcbiAgLy8gTkZUIGFuZCBXZWIzIGludGVncmF0aW9uXHJcbiAgaXNORlRFbGlnaWJsZTogYm9vbGVhbignaXNfbmZ0X2VsaWdpYmxlJykubm90TnVsbCgpLmRlZmF1bHQoZmFsc2UpLFxyXG4gIG5mdENvbnRyYWN0QWRkcmVzczogdGV4dCgnbmZ0X2NvbnRyYWN0X2FkZHJlc3MnKSxcclxuICBuZnRUb2tlbklkOiB0ZXh0KCduZnRfdG9rZW5faWQnKSxcclxuICBcclxuICBtZXRhZGF0YToganNvbignbWV0YWRhdGEnKSwgLy8gQWRkaXRpb25hbCBtZXRhZGF0YSBsaWtlIHRhZ3MsIHJhdGluZ3MsIGV0Yy5cclxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCgnY3JlYXRlZF9hdCcsIHsgbW9kZTogJ2RhdGUnIH0pLm5vdE51bGwoKS5kZWZhdWx0Tm93KCksXHJcbiAgdXBkYXRlZEF0OiB0aW1lc3RhbXAoJ3VwZGF0ZWRfYXQnLCB7IG1vZGU6ICdkYXRlJyB9KS5ub3ROdWxsKCkuZGVmYXVsdE5vdygpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBjb21pY1BhZ2VzID0gcGdUYWJsZSgnY29taWNfcGFnZXMnLCB7XHJcbiAgaWQ6IHV1aWQoJ2lkJykucHJpbWFyeUtleSgpLmRlZmF1bHRSYW5kb20oKSxcclxuICBjb21pY0lkOiB1dWlkKCdjb21pY19pZCcpXHJcbiAgICAubm90TnVsbCgpXHJcbiAgICAucmVmZXJlbmNlcygoKSA9PiBjb21pY3MuaWQsIHsgb25EZWxldGU6ICdjYXNjYWRlJyB9KSxcclxuICBwYWdlTnVtYmVyOiBpbnRlZ2VyKCdwYWdlX251bWJlcicpLm5vdE51bGwoKSxcclxuICBpbWFnZVVybDogdGV4dCgnaW1hZ2VfdXJsJykubm90TnVsbCgpLFxyXG4gIGZpbGVJZDogdXVpZCgnZmlsZV9pZCcpLCAvLyBSZWZlcmVuY2UgdG8gZmlsZSBzZXJ2aWNlXHJcbiAgYWx0VGV4dDogdGV4dCgnYWx0X3RleHQnKSxcclxuICBpc1ByZXZpZXc6IGJvb2xlYW4oJ2lzX3ByZXZpZXcnKS5ub3ROdWxsKCkuZGVmYXVsdChmYWxzZSksIC8vIEZvciBmcmVlIHByZXZpZXcgcGFnZXNcclxuICBcclxuICAvLyBJUEZTL05GVCBkYXRhIChvcHRpb25hbClcclxuICBpcGZzSGFzaDogdGV4dCgnaXBmc19oYXNoJyksXHJcbiAgaXBmc1VybDogdGV4dCgnaXBmc191cmwnKSxcclxuICBcclxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCgnY3JlYXRlZF9hdCcsIHsgbW9kZTogJ2RhdGUnIH0pLm5vdE51bGwoKS5kZWZhdWx0Tm93KCksXHJcbiAgdXBkYXRlZEF0OiB0aW1lc3RhbXAoJ3VwZGF0ZWRfYXQnLCB7IG1vZGU6ICdkYXRlJyB9KS5ub3ROdWxsKCkuZGVmYXVsdE5vdygpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCByZWFkaW5nUHJvZ3Jlc3MgPSBwZ1RhYmxlKCdyZWFkaW5nX3Byb2dyZXNzJywge1xyXG4gIGlkOiB1dWlkKCdpZCcpLnByaW1hcnlLZXkoKS5kZWZhdWx0UmFuZG9tKCksXHJcbiAgdXNlcklkOiB1dWlkKCd1c2VyX2lkJylcclxuICAgIC5ub3ROdWxsKClcclxuICAgIC5yZWZlcmVuY2VzKCgpID0+IGF1dGhVc2Vycy5pZCwgeyBvbkRlbGV0ZTogJ2Nhc2NhZGUnIH0pLFxyXG4gIGNvbWljSWQ6IHV1aWQoJ2NvbWljX2lkJylcclxuICAgIC5ub3ROdWxsKClcclxuICAgIC5yZWZlcmVuY2VzKCgpID0+IGNvbWljcy5pZCwgeyBvbkRlbGV0ZTogJ2Nhc2NhZGUnIH0pLFxyXG4gIGN1cnJlbnRQYWdlOiBpbnRlZ2VyKCdjdXJyZW50X3BhZ2UnKS5ub3ROdWxsKCkuZGVmYXVsdCgxKSxcclxuICB0b3RhbFBhZ2VzOiBpbnRlZ2VyKCd0b3RhbF9wYWdlcycpLm5vdE51bGwoKSxcclxuICBjb21wbGV0ZWRBdDogdGltZXN0YW1wKCdjb21wbGV0ZWRfYXQnLCB7IG1vZGU6ICdkYXRlJyB9KSxcclxuICBsYXN0UmVhZEF0OiB0aW1lc3RhbXAoJ2xhc3RfcmVhZF9hdCcsIHsgbW9kZTogJ2RhdGUnIH0pLm5vdE51bGwoKS5kZWZhdWx0Tm93KCksXHJcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoJ2NyZWF0ZWRfYXQnLCB7IG1vZGU6ICdkYXRlJyB9KS5ub3ROdWxsKCkuZGVmYXVsdE5vdygpLFxyXG4gIHVwZGF0ZWRBdDogdGltZXN0YW1wKCd1cGRhdGVkX2F0JywgeyBtb2RlOiAnZGF0ZScgfSkubm90TnVsbCgpLmRlZmF1bHROb3coKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgY29taWNQdXJjaGFzZXMgPSBwZ1RhYmxlKCdjb21pY19wdXJjaGFzZXMnLCB7XHJcbiAgaWQ6IHV1aWQoJ2lkJykucHJpbWFyeUtleSgpLmRlZmF1bHRSYW5kb20oKSxcclxuICB1c2VySWQ6IHV1aWQoJ3VzZXJfaWQnKVxyXG4gICAgLm5vdE51bGwoKVxyXG4gICAgLnJlZmVyZW5jZXMoKCkgPT4gYXV0aFVzZXJzLmlkLCB7IG9uRGVsZXRlOiAnY2FzY2FkZScgfSksXHJcbiAgY29taWNJZDogdXVpZCgnY29taWNfaWQnKVxyXG4gICAgLm5vdE51bGwoKVxyXG4gICAgLnJlZmVyZW5jZXMoKCkgPT4gY29taWNzLmlkLCB7IG9uRGVsZXRlOiAnY2FzY2FkZScgfSksXHJcbiAgcHVyY2hhc2VQcmljZTogZGVjaW1hbCgncHVyY2hhc2VfcHJpY2UnLCB7IHByZWNpc2lvbjogMTAsIHNjYWxlOiAyIH0pLm5vdE51bGwoKSxcclxuICB0cmFuc2FjdGlvbklkOiB0ZXh0KCd0cmFuc2FjdGlvbl9pZCcpLCAvLyBSZWZlcmVuY2UgdG8gd2FsbGV0IHRyYW5zYWN0aW9uXHJcbiAgcHVyY2hhc2VkQXQ6IHRpbWVzdGFtcCgncHVyY2hhc2VkX2F0JywgeyBtb2RlOiAnZGF0ZScgfSkubm90TnVsbCgpLmRlZmF1bHROb3coKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgY29taWNSZXZpZXdzID0gcGdUYWJsZSgnY29taWNfcmV2aWV3cycsIHtcclxuICBpZDogdXVpZCgnaWQnKS5wcmltYXJ5S2V5KCkuZGVmYXVsdFJhbmRvbSgpLFxyXG4gIHVzZXJJZDogdXVpZCgndXNlcl9pZCcpXHJcbiAgICAubm90TnVsbCgpXHJcbiAgICAucmVmZXJlbmNlcygoKSA9PiBhdXRoVXNlcnMuaWQsIHsgb25EZWxldGU6ICdjYXNjYWRlJyB9KSxcclxuICBjb21pY0lkOiB1dWlkKCdjb21pY19pZCcpXHJcbiAgICAubm90TnVsbCgpXHJcbiAgICAucmVmZXJlbmNlcygoKSA9PiBjb21pY3MuaWQsIHsgb25EZWxldGU6ICdjYXNjYWRlJyB9KSxcclxuICByYXRpbmc6IGludGVnZXIoJ3JhdGluZycpLm5vdE51bGwoKSwgLy8gMS01IHN0YXJzXHJcbiAgcmV2aWV3OiB0ZXh0KCdyZXZpZXcnKSxcclxuICBpc1B1Ymxpc2hlZDogYm9vbGVhbignaXNfcHVibGlzaGVkJykubm90TnVsbCgpLmRlZmF1bHQodHJ1ZSksXHJcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoJ2NyZWF0ZWRfYXQnLCB7IG1vZGU6ICdkYXRlJyB9KS5ub3ROdWxsKCkuZGVmYXVsdE5vdygpLFxyXG4gIHVwZGF0ZWRBdDogdGltZXN0YW1wKCd1cGRhdGVkX2F0JywgeyBtb2RlOiAnZGF0ZScgfSkubm90TnVsbCgpLmRlZmF1bHROb3coKSxcclxufSk7XHJcblxyXG5leHBvcnQgdHlwZSBJbnNlcnRDb21pYyA9IHR5cGVvZiBjb21pY3MuJGluZmVySW5zZXJ0O1xyXG5leHBvcnQgdHlwZSBTZWxlY3RDb21pYyA9IHR5cGVvZiBjb21pY3MuJGluZmVyU2VsZWN0O1xyXG5cclxuZXhwb3J0IHR5cGUgSW5zZXJ0Q29taWNQYWdlID0gdHlwZW9mIGNvbWljUGFnZXMuJGluZmVySW5zZXJ0O1xyXG5leHBvcnQgdHlwZSBTZWxlY3RDb21pY1BhZ2UgPSB0eXBlb2YgY29taWNQYWdlcy4kaW5mZXJTZWxlY3Q7XHJcblxyXG5leHBvcnQgdHlwZSBJbnNlcnRSZWFkaW5nUHJvZ3Jlc3MgPSB0eXBlb2YgcmVhZGluZ1Byb2dyZXNzLiRpbmZlckluc2VydDtcclxuZXhwb3J0IHR5cGUgU2VsZWN0UmVhZGluZ1Byb2dyZXNzID0gdHlwZW9mIHJlYWRpbmdQcm9ncmVzcy4kaW5mZXJTZWxlY3Q7XHJcblxyXG5leHBvcnQgdHlwZSBJbnNlcnRDb21pY1B1cmNoYXNlID0gdHlwZW9mIGNvbWljUHVyY2hhc2VzLiRpbmZlckluc2VydDtcclxuZXhwb3J0IHR5cGUgU2VsZWN0Q29taWNQdXJjaGFzZSA9IHR5cGVvZiBjb21pY1B1cmNoYXNlcy4kaW5mZXJTZWxlY3Q7XHJcblxyXG5leHBvcnQgdHlwZSBJbnNlcnRDb21pY1JldmlldyA9IHR5cGVvZiBjb21pY1Jldmlld3MuJGluZmVySW5zZXJ0O1xyXG5leHBvcnQgdHlwZSBTZWxlY3RDb21pY1JldmlldyA9IHR5cGVvZiBjb21pY1Jldmlld3MuJGluZmVyU2VsZWN0OyJdfQ==